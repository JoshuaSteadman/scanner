<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automate Report Generation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        h1 {
            margin: 0;
            color: #333;
        }
        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        a {
            color: #007BFF;
            text-decoration: none;
        }
        .logo {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 100px;
            height: auto;
        }
    </style>
</head>
<body>
    <img class="logo" src="https://www.usfoods.com/content/dam/dce/images/general/new_usf_logo_0914.png" alt="US Foods Logo">
    <div class="container">
        <h1>US Foods</h1>
        <button id="loginBtn">AirClic Login</button>
        <button id="centerReportBtn" disabled>Center Report CSV</button>
        <button id="driverCheckinReportBtn" disabled>Driver Checkin Report CSV</button>
        <button id="driverCheckinReportUrlBtn" disabled>Driver Checkin Report URL</button>
        <button id="driverCheckinReportPdfBtn" disabled>Driver Checkin Report PDF</button>
        <p><a href="https://usfoodsdci.netlify.app/" target="_blank">Exceptions Report Viewer</a></p>
        <p><a href="https://reportcenter.netlify.app" target="_blank">Center Report Viewer</a></p>
    </div>
    <script>
        document.getElementById('loginBtn').addEventListener('click', function() {
            window.open('https://usfoods.airclic.com/web/login.xhtml', '_blank');
            document.getElementById('centerReportBtn').disabled = false;
            document.getElementById('driverCheckinReportBtn').disabled = false;
            document.getElementById('driverCheckinReportUrlBtn').disabled = false;
            document.getElementById('driverCheckinReportPdfBtn').disabled = false;
        });

        document.getElementById('centerReportBtn').addEventListener('click', function() {
            dynamicCenterReportUrl();
        });

        document.getElementById('driverCheckinReportBtn').addEventListener('click', function() {
            dynamicReportCSV();
        });

        document.getElementById('driverCheckinReportUrlBtn').addEventListener('click', function() {
            dynamicReportURL();
        });

        document.getElementById('driverCheckinReportPdfBtn').addEventListener('click', function() {
            dynamicReportPDF();
        });

        function dynamicCenterReportUrl() {
            const url = generateDynamicReportUrl("https://usfoods.airclic.com/web/reports/report?centerId=62&shipmentItemsType=all&orderNumber=&routeNumber=-1&supplierId=-1&webUserId=495259&reportId=5&scheduleEntryTypeId=-1&handheldNumber=&palletNumber=&purposeId=2&lookupType=matches&customerNumber=&customerName=&receiverId=-1&driverId=-1&reasonId=1&referenceNumber=&vehicleId=-1&containerId=&shipmentNumber=&centerName=&reportFormat=CSV");
            window.open(url, '_blank');
        }

        function dynamicReportCSV() {
            const url = generateDynamicReportUrl("https://usfoods.airclic.com/web/reports/report?centerId=62&shipmentItemsType=all&orderNumber=&routeNumber=-1&supplierId=-1&webUserId=495259&reportId=82&scheduleEntryTypeId=-1&handheldNumber=&palletNumber=&purposeId=2&lookupType=matches&customerNumber=&customerName=&receiverId=-1&driverId=-1&reasonId=1&referenceNumber=&vehicleId=-1&containerId=&shipmentNumber=&centerName=&reportFormat=CSV");
            window.open(url, '_blank');
        }

        function dynamicReportURL() {
            const url = generateDynamicReportUrl("https://usfoods.airclic.com/web/ui/reports/report.xhtml?reportId=82&centerId=62&driverId=-1&webUserId=495259&purposeId=2&reasonId=1&orderNumber=&referenceNumber=&palletNumber=&routeNumber=-1&vehicleId=-1&scheduleEntryTypeId=-1&customerNumber=&customerName=&containerId=&lookupType=matches&handheldNumber=&centerName=&shipmentItemsType=all&receiverId=-1&supplierId=-1&shipmentNumber=");
            window.open(url, '_blank');
        }

        function dynamicReportPDF() {
            const url = generateDynamicReportUrl("https://usfoods.airclic.com/web/reports/report.pdf?centerId=62&shipmentItemsType=all&orderNumber=&routeNumber=-1&supplierId=-1&webUserId=495259&reportId=82&scheduleEntryTypeId=-1&handheldNumber=&palletNumber=&purposeId=2&lookupType=matches&customerNumber=&customerName=&receiverId=-1&driverId=-1&reasonId=1&referenceNumber=&vehicleId=-1&containerId=&shipmentNumber=&centerName=&reportFormat=PDF");
            window.open(url, '_blank');
        }

        function generateDynamicReportUrl(baseURL) {
            var currentDate = new Date();
            var fromDate;

            // Calculate the start date based on the current day
            switch (currentDate.getDay()) {
                case 0: // Sunday
                    fromDate = new Date(currentDate);
                    fromDate.setDate(fromDate.getDate() - 2); // Friday
                    break;
                case 6: // Saturday
                    fromDate = new Date(currentDate);
                    fromDate.setDate(fromDate.getDate() - 1); // Friday
                    break;
                default:
                    fromDate = new Date(currentDate);
                    fromDate.setDate(fromDate.getDate() - 1); // Previous day
                    break;
            }

            var fromTimestamp = dateToTimestamp(fromDate, 1, 0); // 1 AM
            var toTimestamp = dateToTimestamp(currentDate, 23, 59, 59); // Midnight

            // Construct the URL with dynamic date parameters
            return baseURL + "&from=" + fromTimestamp + "&to=" + toTimestamp;
        }

        function dateToTimestamp(dateVal, hour, minute, second = 0) {
            dateVal.setHours(hour, minute, second, 0); // Set the specific time
            var timestamp = dateVal.getTime(); // Get the time in milliseconds since 1970-01-01
            return timestamp.toString();
        }
    </script>
</body>
</html>
